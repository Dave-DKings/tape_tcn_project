{
  "Run_Context": {
    "timestamp": "20260219_210119",
    "experiment_index": 6,
    "experiment_name": "TCN_FUSION Enhanced + TAPE Three-Component",
    "seed": 6042,
    "train_days": 4512,
    "test_days": 1002,
    "train_date_min": "2003-10-01 00:00:00",
    "train_date_max": "2021-09-01 00:00:00",
    "test_date_min": "2021-09-02 00:00:00",
    "test_date_max": "2025-08-29 00:00:00",
    "active_feature_manifest_path": "/content/adaptive_portfolio_rl/tcn_fusion_results/logs/Exp6_TCN_FUSION_Enhanced_TAPE_training_20260219_210119_active_feature_manifest.json",
    "step_diagnostics_path": "/content/adaptive_portfolio_rl/tcn_fusion_results/logs/Exp6_TCN_FUSION_Enhanced_TAPE_training_20260219_210119_step_diagnostics.csv"
  },
  "Architecture_Settings": {
    "architecture": "TCN_FUSION",
    "actor_critic_type": "TCN_FUSION",
    "resolved_architecture": "TCN_FUSION",
    "use_attention": false,
    "use_fusion": true,
    "use_covariance": true,
    "dirichlet_alpha_activation": "elu",
    "dirichlet_epsilon": {
      "max": 0.5,
      "min": 0.1
    },
    "dirichlet_exp_clip": [
      -5.0,
      3.0
    ],
    "tcn_hidden_activation": "relu",
    "agent_params_template": {
      "actor_critic_type": "TCN_FUSION",
      "use_attention": false,
      "use_fusion": true,
      "actor_hidden_dims": [
        256,
        128
      ],
      "critic_hidden_dims": [
        256,
        128
      ],
      "sequence_length": 60,
      "tcn_filters": [
        64,
        128,
        128
      ],
      "tcn_kernel_size": 5,
      "tcn_dilations": [
        2,
        4,
        8
      ],
      "tcn_dropout": 0.2,
      "attention_heads": 4,
      "attention_dim": 64,
      "attention_dropout": 0.1,
      "fusion_embed_dim": 128,
      "fusion_attention_heads": 4,
      "fusion_dropout": 0.1,
      "dirichlet_alpha_activation": "elu",
      "dirichlet_exp_clip": [
        -5.0,
        3.0
      ],
      "dirichlet_epsilon": {
        "max": 0.5,
        "min": 0.1
      },
      "evaluation_mode": "mode",
      "ppo_params": {
        "gamma": 0.99,
        "gae_lambda": 0.9,
        "policy_clip": 0.08,
        "entropy_coef": 0.002,
        "vf_coef": 0.5,
        "num_ppo_epochs": 1,
        "batch_size_ppo": 252,
        "actor_lr": 1.2e-05,
        "critic_lr": 0.00015,
        "max_grad_norm": 0.15,
        "value_clip": 0.2,
        "target_kl": 0.02,
        "kl_stop_multiplier": 1.5,
        "minibatches_before_kl_stop": 1,
        "use_risk_aux_loss": true,
        "risk_aux_return_feature_index": 0,
        "risk_aux_cash_return": 0.0,
        "risk_aux_sharpe_coef": 0.05,
        "risk_aux_mvo_coef": 0.002,
        "risk_aux_mvo_cov_ridge": 0.001,
        "risk_aux_mvo_long_only": true,
        "risk_aux_mvo_risky_budget": 0.95
      },
      "max_total_timesteps": 100000,
      "num_assets": 10,
      "state_layout": {
        "structured_observation": true,
        "num_assets": 10,
        "asset_feature_dim": 39,
        "global_feature_dim": 27,
        "local_flat_dim": 390,
        "total_observation_dim": 417,
        "asset_feature_columns": [
          "LogReturn_1d",
          "LogReturn_5d",
          "LogReturn_10d",
          "LogReturn_21d",
          "RollingVolatility_21d",
          "DownsideSemiVar_21d",
          "RealizedSkew_21d",
          "RealizedKurtosis_21d",
          "MACD_12_26_9",
          "MACDh_12_26_9",
          "MACDs_12_26_9",
          "RSI_14",
          "STOCHd_14_3_3",
          "ADX_14",
          "OBV",
          "MFI_14",
          "Regime_Volatility_Ratio",
          "Regime_Price_vs_SMA_Short",
          "Regime_SMA_Short_Slope",
          "Regime_SMA_Long_Slope",
          "Regime_Momentum_Short",
          "Regime_Momentum_Long",
          "Regime_Corr_to_Market",
          "Residual_Momentum_21",
          "Volume_Percentile_63",
          "ShortTerm_Reversal_5",
          "VolOfVol_63",
          "Beta_to_Market",
          "OBV_Delta_Norm_21",
          "Actuarial_Expected_Recovery",
          "Actuarial_Prob_30d",
          "Actuarial_Prob_60d",
          "Actuarial_Reserve_Severity",
          "MomentumRank_21d",
          "MomentumRank_63d",
          "MomentumRank_252d",
          "LogReturn_1d_ZScore",
          "RollingVolatility_21d_ZScore",
          "RSI_14_ZScore"
        ],
        "global_feature_columns": [
          "Covariance_Eigenvalue_0",
          "Covariance_Eigenvalue_1",
          "Covariance_Eigenvalue_2",
          "Fundamental_FCFE_Delta",
          "Fundamental_Revenue_Delta",
          "Fundamental_NCFO_Delta",
          "Fundamental_FCFE_Sign",
          "Fundamental_Staleness_Days",
          "Fundamental_Staleness_Quarters",
          "Regime_Breadth_Positive",
          "YieldCurve_Spread",
          "YieldCurve_Inverted_Flag",
          "EFFR_diff",
          "EFFR_zscore",
          "SOFR_diff",
          "FEDFUNDS_diff",
          "FEDFUNDS_zscore",
          "DGS10_diff",
          "DGS10_slope",
          "DGS2_diff",
          "TIPS10Y_diff",
          "BreakevenInf10Y_diff",
          "BreakevenInf5Y_diff",
          "IG_Credit_diff",
          "IG_Credit_zscore",
          "HY_Credit_diff",
          "HY_Credit_zscore"
        ],
        "active_feature_columns": [
          "LogReturn_1d",
          "LogReturn_5d",
          "LogReturn_10d",
          "LogReturn_21d",
          "RollingVolatility_21d",
          "DownsideSemiVar_21d",
          "RealizedSkew_21d",
          "RealizedKurtosis_21d",
          "MACD_12_26_9",
          "MACDh_12_26_9",
          "MACDs_12_26_9",
          "RSI_14",
          "STOCHd_14_3_3",
          "ADX_14",
          "OBV",
          "MFI_14",
          "Covariance_Eigenvalue_0",
          "Covariance_Eigenvalue_1",
          "Covariance_Eigenvalue_2",
          "Fundamental_FCFE_Delta",
          "Fundamental_Revenue_Delta",
          "Fundamental_NCFO_Delta",
          "Fundamental_FCFE_Sign",
          "Fundamental_Staleness_Days",
          "Fundamental_Staleness_Quarters",
          "Regime_Volatility_Ratio",
          "Regime_Price_vs_SMA_Short",
          "Regime_SMA_Short_Slope",
          "Regime_SMA_Long_Slope",
          "Regime_Momentum_Short",
          "Regime_Momentum_Long",
          "Regime_Breadth_Positive",
          "Regime_Corr_to_Market",
          "Residual_Momentum_21",
          "Volume_Percentile_63",
          "YieldCurve_Spread",
          "YieldCurve_Inverted_Flag",
          "ShortTerm_Reversal_5",
          "VolOfVol_63",
          "Beta_to_Market",
          "OBV_Delta_Norm_21",
          "Actuarial_Expected_Recovery",
          "Actuarial_Prob_30d",
          "Actuarial_Prob_60d",
          "Actuarial_Reserve_Severity",
          "EFFR_diff",
          "EFFR_zscore",
          "SOFR_diff",
          "FEDFUNDS_diff",
          "FEDFUNDS_zscore",
          "DGS10_diff",
          "DGS10_slope",
          "DGS2_diff",
          "TIPS10Y_diff",
          "BreakevenInf10Y_diff",
          "BreakevenInf5Y_diff",
          "IG_Credit_diff",
          "IG_Credit_zscore",
          "HY_Credit_diff",
          "HY_Credit_zscore",
          "MomentumRank_21d",
          "MomentumRank_63d",
          "MomentumRank_252d",
          "LogReturn_1d_ZScore",
          "RollingVolatility_21d_ZScore",
          "RSI_14_ZScore"
        ]
      },
      "debug_prints": false
    },
    "agent_params_effective": {
      "resolved_architecture": "TCN_FUSION",
      "actor_critic_type": "TCN_FUSION",
      "use_attention": false,
      "use_fusion": true,
      "sequence_length": 60,
      "dirichlet_alpha_activation": "elu",
      "dirichlet_epsilon": {
        "max": 0.5,
        "min": 0.1
      },
      "dirichlet_exp_clip": [
        -5.0,
        3.0
      ],
      "num_assets": 10,
      "max_total_timesteps": 100000,
      "evaluation_mode": "mode",
      "debug_prints": false,
      "ppo_params": {
        "gamma": 0.99,
        "gae_lambda": 0.9,
        "policy_clip": 0.08,
        "entropy_coef": 0.002,
        "vf_coef": 0.5,
        "num_ppo_epochs": 1,
        "batch_size_ppo": 252,
        "actor_lr": 1.2e-05,
        "critic_lr": 0.00015,
        "max_grad_norm": 0.15,
        "value_clip": 0.2,
        "target_kl": 0.02,
        "kl_stop_multiplier": 1.5,
        "minibatches_before_kl_stop": 1,
        "use_risk_aux_loss": true,
        "risk_aux_return_feature_index": 0,
        "risk_aux_cash_return": 0.0,
        "risk_aux_sharpe_coef": 0.05,
        "risk_aux_mvo_coef": 0.002,
        "risk_aux_mvo_cov_ridge": 0.001,
        "risk_aux_mvo_long_only": true,
        "risk_aux_mvo_risky_budget": 0.95
      },
      "actor_hidden_dims": [
        256,
        128
      ],
      "critic_hidden_dims": [
        256,
        128
      ],
      "tcn_dropout": 0.2,
      "tcn_filters": [
        64,
        128,
        128
      ],
      "tcn_kernel_size": 5,
      "tcn_dilations": [
        2,
        4,
        8
      ],
      "fusion_embed_dim": 128,
      "fusion_attention_heads": 4,
      "fusion_dropout": 0.1
    },
    "agent_params_unused_for_resolved_architecture": [
      "tcn_dilations",
      "tcn_dropout",
      "tcn_filters",
      "tcn_kernel_size"
    ]
  },
  "Feature_Groups": {
    "fundamental_features": {
      "enabled": true,
      "data_path": "/content/adaptive_portfolio_rl/data/quarterly_fundamentals.csv",
      "lag_quarters": 8,
      "staleness_days_normalizer": 90.0
    },
    "macro_data": {
      "fred_api_key": "da9d24dd8de4f924dcbc8416e539b4ef",
      "fred_series_config": [
        {
          "code": "EFFR",
          "name": "EFFR",
          "freq": "d",
          "calc": [
            "diff",
            "zscore"
          ]
        },
        {
          "code": "SOFR",
          "name": "SOFR",
          "freq": "d",
          "calc": [
            "level",
            "diff"
          ]
        },
        {
          "code": "FEDFUNDS",
          "name": "FEDFUNDS",
          "freq": "m",
          "calc": [
            "diff",
            "zscore"
          ]
        },
        {
          "code": "DGS10",
          "name": "DGS10",
          "freq": "d",
          "calc": [
            "level",
            "diff",
            "slope"
          ]
        },
        {
          "code": "DGS2",
          "name": "DGS2",
          "freq": "d",
          "calc": [
            "level",
            "diff"
          ]
        },
        {
          "code": "T10Y2Y",
          "name": "T10Y2Y",
          "freq": "d",
          "calc": [
            "level"
          ]
        },
        {
          "code": "DFII10",
          "name": "TIPS10Y",
          "freq": "d",
          "calc": [
            "level",
            "diff"
          ]
        },
        {
          "code": "T10YIE",
          "name": "BreakevenInf10Y",
          "freq": "d",
          "calc": [
            "level",
            "diff"
          ]
        },
        {
          "code": "T5YIFR",
          "name": "BreakevenInf5Y",
          "freq": "d",
          "calc": [
            "level",
            "diff"
          ]
        },
        {
          "code": "WALCL",
          "name": "FedBalanceSheet",
          "freq": "w",
          "calc": [
            "level",
            "diff"
          ]
        },
        {
          "code": "RRPONTSYD",
          "name": "ON_RRP",
          "freq": "d",
          "calc": [
            "level",
            "diff"
          ]
        },
        {
          "code": "CPIAUCSL",
          "name": "CPI",
          "freq": "m",
          "calc": [
            "yoy",
            "mom"
          ]
        },
        {
          "code": "PPIACO",
          "name": "PPI",
          "freq": "m",
          "calc": [
            "yoy",
            "mom"
          ]
        },
        {
          "code": "UNRATE",
          "name": "UNRATE",
          "freq": "m",
          "calc": [
            "level",
            "diff",
            "zscore"
          ]
        },
        {
          "code": "PAYEMS",
          "name": "PAYEMS",
          "freq": "m",
          "calc": [
            "level",
            "diff",
            "yoy"
          ]
        },
        {
          "code": "INDPRO",
          "name": "INDPRO",
          "freq": "m",
          "calc": [
            "level",
            "diff",
            "yoy"
          ]
        },
        {
          "code": "BAMLC0A4CBBBEY",
          "name": "IG_Credit",
          "freq": "d",
          "calc": [
            "level",
            "diff",
            "zscore"
          ]
        },
        {
          "code": "BAMLH0A0HYM2",
          "name": "HY_Credit",
          "freq": "d",
          "calc": [
            "level",
            "diff",
            "zscore"
          ]
        },
        {
          "code": "VIXCLS",
          "name": "VIX",
          "freq": "d",
          "calc": [
            "level",
            "zscore"
          ]
        }
      ],
      "business_days_only": true,
      "ffill_limit": null
    },
    "alpha_features": {
      "enabled": true,
      "cross_sectional_column": "LogReturn_1d",
      "residual_momentum_window": 21,
      "volume_percentile_window": 63,
      "reversal_window": 5,
      "vol_of_vol_window": 63,
      "beta_window": 63,
      "obv_window": 21,
      "yield_curve": {
        "long_col": "DGS10_level",
        "short_col": "DGS2_level"
      },
      "retain_market_return": false,
      "epsilon": 1e-09
    },
    "cross_sectional_features": {
      "enabled": true,
      "momentum_windows": [
        21,
        63,
        252
      ],
      "zscore_features": [
        "LogReturn_1d",
        "RollingVolatility_21d",
        "RSI_14"
      ],
      "include_beta_flags": false,
      "high_beta_threshold": 1.2,
      "low_beta_threshold": 0.8
    },
    "actuarial_features": {
      "enabled": true,
      "severity_buckets": [
        0.05,
        0.1,
        0.15,
        0.2,
        0.25,
        0.3
      ],
      "development_horizons": [
        10,
        20,
        30,
        60,
        90,
        120
      ],
      "min_events_for_credibility": 5
    },
    "actuarial_columns_detected": [
      "Actuarial_Expected_Recovery",
      "Actuarial_Prob_30d",
      "Actuarial_Prob_60d",
      "Actuarial_Reserve_Severity"
    ]
  },
  "Training_Hyperparameters": {
    "max_total_timesteps": 100000,
    "timesteps_per_ppo_update": 256,
    "timesteps_per_ppo_update_schedule": [
      {
        "threshold": 0,
        "timesteps_per_update": 256
      },
      {
        "threshold": 20000,
        "timesteps_per_update": 384
      },
      {
        "threshold": 50000,
        "timesteps_per_update": 512
      }
    ],
    "actor_lr_schedule": [
      {
        "threshold": 0,
        "lr": 1.2e-05
      },
      {
        "threshold": 20000,
        "lr": 1e-05
      },
      {
        "threshold": 40000,
        "lr": 8e-06
      }
    ],
    "num_ppo_epochs": 1,
    "batch_size_ppo": 64,
    "batch_size_ppo_schedule": [
      {
        "threshold": 0,
        "batch_size": 64
      },
      {
        "threshold": 20000,
        "batch_size": 96
      },
      {
        "threshold": 50000,
        "batch_size": 128
      }
    ],
    "batch_size_ppo_auto_from_rollout_schedule": false,
    "use_episode_length_curriculum": true,
    "episode_length_curriculum_schedule": [
      {
        "threshold": 0,
        "limit": 252
      },
      {
        "threshold": 10000,
        "limit": 504
      },
      {
        "threshold": 25000,
        "limit": 756
      },
      {
        "threshold": 40000,
        "limit": null
      }
    ],
    "episode_length_limit_initial": 252,
    "turnover_penalty_curriculum": {
      "0": 2.0,
      "10000": 2.5,
      "25000": 3.0,
      "40000": 3.5
    },
    "evaluation_turnover_penalty_scalar": 3.5,
    "log_step_diagnostics": true,
    "gamma": 0.99
  },
  "Reward_and_Environment": {
    "dsr_scalar": 2.0,
    "target_turnover": 0.35,
    "turnover_target_band": 0.2,
    "tape_terminal_scalar": 6.0,
    "tape_terminal_clip": 6.0,
    "tape_terminal_bonus_mode": "signed",
    "tape_terminal_baseline": 0.2,
    "tape_terminal_neutral_band_enabled": true,
    "tape_terminal_neutral_band_halfwidth": 0.005,
    "tape_terminal_gate_a_enabled": true,
    "tape_terminal_gate_a_sharpe_threshold": 0.0,
    "tape_terminal_gate_a_max_drawdown": 0.25,
    "drawdown_constraint": {
      "enabled": true,
      "target": 0.18,
      "penalty_coef": 1.5,
      "dual_learning_rate": 0.1,
      "lambda_init": 0.5,
      "lambda_floor": 0.0,
      "lambda_max": 5.0,
      "tolerance": -0.015,
      "penalty_reference": "trigger_boundary",
      "cooling_rate": 0.35,
      "lambda_carry_decay": 0.7
    },
    "tape_profile_name": "BalancedGrowth",
    "tape_profile_full": {
      "name": "BalancedGrowth",
      "mu": [
        1.0,
        1.2999999523162842,
        -0.15000000596046448,
        0.6000000238418579,
        0.0
      ],
      "k_minus": [
        4.0,
        3.0,
        5.0,
        1.0,
        2.0
      ],
      "k_plus": [
        1.0,
        1.0,
        1.0,
        4.0,
        1.0
      ],
      "weights": [
        0.30000001192092896,
        0.25,
        0.25,
        0.15000000596046448,
        0.05000000074505806
      ],
      "metrics_order": [
        "sharpe",
        "sortino",
        "mdd",
        "turnover",
        "skew"
      ],
      "directions": [
        "increasing",
        "increasing",
        "increasing",
        "decreasing",
        "increasing"
      ],
      "a_bounds": [
        -2.0,
        -1.0,
        -0.3,
        0.0,
        -1.0
      ],
      "b_bounds": [
        3.0,
        4.0,
        0.0,
        0.8,
        1.0
      ]
    },
    "reward_credit_assignment_mode": "step_reward_plus_terminal_bonus",
    "retroactive_episode_reward_scaling": false,
    "training_entrypoint": "src/notebook_helpers/tcn_phase1.py::run_experiment6_tape"
  },
  "Checkpointing": {
    "normal_checkpoint_naming": "exp{exp_idx}_tape_epNN",
    "normal_checkpoint_selection": "latest_episode",
    "rare_checkpoint_selection": "best_sharpe_then_episode",
    "legacy_final_alias_supported": true,
    "tape_checkpoint_threshold_bonus": 4.0,
    "periodic_checkpoint_every_steps": 10000,
    "high_watermark_checkpoint_enabled": true,
    "high_watermark_sharpe_threshold": 0.5,
    "high_watermark_checkpoint_subdir": "high_watermark_checkpoints",
    "high_watermark_logic": "save_on_every_episode_sharpe_threshold",
    "step_sharpe_checkpoint_enabled": false,
    "step_sharpe_checkpoint_threshold": 0.5,
    "step_sharpe_checkpoint_subdir": "step_sharpe_checkpoints",
    "checkpoint_description": "Normal checkpoint episode 33",
    "final_actor_weights_path": "/content/adaptive_portfolio_rl/tcn_fusion_results/exp6_tape_ep33_actor.weights.h5",
    "final_critic_weights_path": "/content/adaptive_portfolio_rl/tcn_fusion_results/exp6_tape_ep33_critic.weights.h5"
  }
}